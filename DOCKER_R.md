# R Analysis Container

## Overview
This Dockerfile packages an R analysis script that processes CSV results from Python FASTA analysis and creates professional visualizations using ggplot2.

## Quick Start

### Build the Image
```bash
docker build -f Dockerfile.r -t fasta-analysis-r:latest .
```

### Run the Container

**Default (ATG motif):**
```bash
docker run --rm -v $(pwd)/results:/app/results fasta-analysis-r:latest
```

**Custom motif (GC example):**
```bash
docker run --rm -v $(pwd)/results:/app/results fasta-analysis-r:latest \
  Rscript fasta_analysis.R data/motif_analysis_GC.csv results GC
```

**Interactive R:**
```bash
docker run --rm -it -v $(pwd)/results:/app/results fasta-analysis-r:latest R
```

## Environment Details

**Base Image:** rocker/r-base:4.3.2
**R Version:** 4.3.2
**Installed Packages:**
- ggplot2 (visualization)
- gridExtra (grid utilities)

## Input Requirements

The R script expects:
- CSV file generated by `fasta_analysis.py`
- Columns: sequence_id, sequence_length, motif, count, frequency

## Output Files

For each analysis, the script generates:

1. **r_motif_barplot_[MOTIF].png** - Bar chart with frequency coloring
2. **r_motif_frequency_[MOTIF].png** - Frequency distribution plot
3. **r_motif_combined_[MOTIF].png** - Combined bar and line chart
4. **r_motif_pie_[MOTIF].png** - Pie chart of contribution
5. **r_analysis_table_[MOTIF].csv** - Summary table
6. **r_analysis_summary_[MOTIF].txt** - Text report with statistics

## Usage Examples

### Analyze ATG Motif
```bash
docker run --rm -v /path/to/results:/app/results fasta-analysis-r:latest
```

### Analyze GC Motif
```bash
docker run --rm -v /path/to/results:/app/results fasta-analysis-r:latest \
  Rscript fasta_analysis.R data/motif_analysis_GC.csv results GC
```

### Analyze Custom Motif
```bash
docker run --rm -v /path/to/results:/app/results fasta-analysis-r:latest \
  Rscript fasta_analysis.R data/motif_analysis_[YOUR_MOTIF].csv results [YOUR_MOTIF]
```

## Data Processing Pipeline

1. **Input:** CSV from Python analysis
2. **Validation:** Read and verify CSV structure
3. **Analysis:** Calculate statistics
4. **Visualization:** Generate 4 different plot types
5. **Output:** Save PNG files and summary reports

## R Script Features

- Automatic CSV loading with error handling
- Statistical summary generation
- Multiple complementary visualizations
- Professional ggplot2 styling
- High-resolution output (300 DPI)
- Summary report generation

## GitHub Codespaces

The R container works in GitHub Codespaces:
- Docker fully functional
- All R packages install successfully
- Visualizations render correctly
- Output accessible on host system

## Integration with Python

Works seamlessly with Python container output:
- ✓ Reads Python-generated CSV files
- ✓ Produces complementary visualizations
- ✓ Uses same data source for cross-validation
- ✓ Can be run in sequence for complete analysis
